<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAI Library</title>
    <style type="text/css">
        /* Themes */
        :root {
            --body-bg: #f5f8fa;
            --border-color: #efefef;
            --messagebox-bg: #ffffff;
            --messagebox-bg-transparent: rgba(255, 255, 255, 0.6);
            --messagebox-shadow: rgba(0, 0, 0, 0.1);
            --font-color: #1f1f1f;
            --rgba-1: rgba(0, 0, 0, 0.05);
            --rgba-2: rgba(0, 0, 0, 0.1);
        }

        .dark_mode {
            --body-bg: #18181b;
            --border-color: #4f4f4f;
            --messagebox-bg: #26272b;
            --messagebox-bg-transparent: rgba(38, 39, 43, 0.8);
            --messagebox-shadow: rgba(0, 0, 0, 0);
            --font-color: #ededed;
            --rgba-1: rgba(255, 255, 255, 0.06);
            --rgba-2: rgba(255, 255, 255, 0.2);
        }



        * {
            box-sizing: border-box;
        }

        button,
        select,
        img {
            user-select: none;
        }

        ol,
        ul,
        li,
        a,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        p {
            text-decoration: none;
            margin: 0;
            padding: 0;
        }

        .italic {
            font-style: italic;
        }

        .bold {
            font-weight: bold;
        }

        .bold-italic {
            font-weight: bold;
            font-style: italic;
        }

        html,
        body {
            min-height: 100%;
        }

        html {
            font-size: 14px;
        }

        body {
            padding: 0;
            margin: 0;
            background-color: var(--body-bg);
            color: var(--font-color);
            transition: all 0.5s ease-in-out 0s;
        }

        .content-cont {
            display: flex;
            flex-direction: row;
        }


        /* NAV / Drawer */

        @keyframes slideIn {
            0% {
                opacity: 0;
                left: -200px;
            }

            100% {
                opacity: 1;
                left: 0;
            }
        }

        .drawer-cont.active {
            display: block;
        }

        .drawer-cont {
            display: none;
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 100;
        }

        nav {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            max-width: 80%;
            background-color: var(--body-bg);

            display: flex;
            flex-direction: column;
            padding: 10px 0;
            overflow: hidden;
            animation: slideIn 0.2s ease-in-out;
            -webkit-box-shadow: 4px 0px 15px 0px rgba(0, 0, 0, 0.2);
            -moz-box-shadow: 4px 0px 15px 0px rgba(0, 0, 0, 0.2);
            box-shadow: 4px 0px 15px 0px rgba(0, 0, 0, 0.2);
        }

        .nav-header {
            width: 100%;
            display: flex;
            flex-direction: column;
            padding: 0 10px 0 20px;
            margin-bottom: 20px;
            gap: 10px;
        }

        .close_drawer-btn {
            align-self: flex-end;
            padding: 10px;
            transition: background-color 0.1s ease-in-out;
            cursor: pointer;
            border-radius: 8px;
        }

        .close_drawer-btn:hover {
            background-color: var(--rgba-1);
        }

        .close_drawer-btn svg {
            display: flex;
            width: 30px;
            height: 30px;
            color: var(--font-color);
        }

        /*.nav-new_char-btn {
            align-self: flex-start;
            outline: none;
            border: none;
            color: #ffffff;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 1.1rem;
            cursor: pointer;
            background-color: #4e9733;
            transition: background-color 0.1s ease-in-out;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        .nav-new_char-btn:hover {
            background-color: #6ba755;
        }*/

        .history_list-header {
            font-size: 1.5rem;
            padding: 10px 20px;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            margin-bottom: 10px;
        }

        .history_list {
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .history_item {
            transition: background-color 0.1s ease-in-out;
            padding: 20px 30px 20px 20px;
            cursor: pointer;
            border-bottom: 1px solid var(--rgba-2);
        }

        .history_item:first-child {
            border-top: 1px solid var(--rgba-2);
        }

        .history_item:hover {
            background-color: var(--rgba-1);
        }

        .history_item p {
            font-family: Arial, Helvetica, sans-serif;
        }

        .history_item p .chat-date {
            font-style: italic;
            font-size: 1.3rem;
            margin-bottom: 6px;
        }

        /*nav .char-item {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 10px;
            transition: background-color 0.1s ease-in-out;
            padding: 10px 40px 10px 20px;
            cursor: pointer;
        }

        nav .char-item:hover {
            background-color: var(--rgba-1);
        }

        nav .nav-avatar-wrap {
            width: 40px;
            height: 40px;
        }

        nav .nav-avatar-wrap img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        nav .char-item span {
            font-size: 1.3rem;
            font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
        }*/

        /* MAIN */
        main {
            display: flex;
            flex-direction: column;
            padding: 0 4%;
            width: 100%;
        }

        /* HEADER */
        header {
            padding: 6px 6px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 16px;
        }

        .open_drawer-wrap svg {
            display: flex;
            width: 46px;
            height: 46px;
            color: var(--font-color);
        }


        .theme_switch {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }

        .theme_switch span {
            font-size: 1.1rem;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        .change-bg-wrap {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 5px;
        }

        .change-bg {
            outline: transparent;
            border: 1px solid var(--border-color);
            color: var(--font-color);
            background-color: var(--body-bg);
            padding: 4px 5px;
            font-size: 1.1rem;
            border-radius: 4px;
            cursor: pointer;
        }

        .change-bg-wrap .delete-bg {
            color: var(--font-color);
            cursor: pointer;
            display: flex;
        }

        .change-bg-wrap .delete-bg:hover {
            color: #e20909;
        }

        .dark-mode-span {
            display: none;
        }

        .tswitch_box[type=checkbox] {
            height: 0;
            width: 0;
            visibility: hidden;
            position: absolute;
        }

        .tswitch_label {
            cursor: pointer;
            text-indent: -9999px;
            width: 60px;
            height: 30px;
            display: block;
            border-radius: 15px;
            position: relative;
            border: 1px solid #323232;
            background: #f5f8fa;
        }

        .tswitch_label:after {
            content: '';
            position: absolute;
            top: 4px;
            left: 4px;
            width: 20px;
            height: 20px;
            border-radius: 50px;
            transition: 0.2s;
            background: #323232;
        }

        .tswitch_box:checked+label {
            background: #323232;
            border: 1px solid #f5f8fa;
        }

        .tswitch_box:checked+label:after {
            left: calc(100% - 5px);
            transform: translateX(-100%);
            background: #f5f8fa;
        }

        .tswitch_label:active:after {
            width: 25px;
        }

        /*.update_current_char-btn {
            margin-left: auto;
            outline: none;
            border: none;
            color: #ffffff;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 1rem;
            align-self: center;
            cursor: pointer;
            background-color: #336c97;
            transition: background-color 0.1s ease-in-out;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        .update_current_char-btn:hover {
            background-color: #5f829d;
        }*/

        body.custom-bg {
            background-repeat: no-repeat;
            background-size: cover;
            background-position: 50% 50%;
            background-attachment: fixed;
        }

        body.custom-bg .chat .chat_content-wrap {
            background-color: var(--messagebox-bg-transparent) !important;
        }


        /* CONVERSATION */
        .character_name-cont {
            text-align: center;
            padding: 20px 10px;
        }

        .character_name-cont h3 {
            font-size: 1.3rem;
            font-weight: 400;
            font-family: Verdana, Geneva, Tahoma, sans-serif;
        }

        .chat {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-self: center;
            padding-bottom: 30px;
        }

        .chat_message-item {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            gap: 10px;
        }

        .chat .avatar-wrap {
            flex-shrink: 0;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            overflow: hidden;
        }

        .chat .avatar-wrap>* {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .chat .avatar-wrap .no_avatar-user {
            background-color: #5157cf;
        }

        .chat .avatar-wrap .no_avatar-char {
            background-color: #e20909;
        }

        .chat .chat_content-wrap {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 7px;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 4px var(--messagebox-shadow);
            background-color: var(--messagebox-bg);
            overflow: hidden;
        }

        .chat .chat_content-wrap h5 {
            font-size: 1rem;
            font-weight: bold;
            font-family: Arial, Helvetica, sans-serif;
        }

        .chat .chat_content-wrap .message-wrap {
            font-size: 1rem;
            font-family: Arial, Helvetica, sans-serif;
        }


        @media (min-width: 576px) {}

        @media (min-width: 768px) {
            html {
                font-size: 16px;
            }

            nav {
                min-width: 40%;
            }

            header {
                padding: 14px 20px;
            }

            .dark-mode-span {
                display: block;
            }

            .open_drawer-wrap {
                padding: 4px;
                cursor: pointer;
                border-radius: 6px;
                transition: background-color 0.1s ease-in-out;
            }

            .open_drawer-wrap:hover {
                background-color: var(--rgba-1);
            }

            .chat {
                width: 80%;
            }

            .chat .chat_content-wrap {
                padding: 14px;
            }
        }

        @media (min-width: 992px) {
            .chat {
                width: 70%;
            }
        }

        @media (min-width: 1200px) {}

        @media (min-width: 1400px) {}
    </style>
</head>

<body>
    <template id="message_item_template">
        <div class="chat_message-item">
            <div class="avatar-wrap">

            </div>
            <div class="chat_content-wrap">
                <h5>

                </h5>
                <div class="message-wrap">
                    <p>

                    </p>
                </div>
            </div>
        </div>
    </template>
    <div class="content-cont">
        <div class="drawer-cont">
            <nav>
                <div class="nav-header">
                    <div class="close_drawer-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-x-lg" viewBox="0 0 16 16">
                            <path
                                d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                        </svg>
                    </div>
                </div>
                <div class="history_list-header">
                    <span>History</span>
                </div>
                <div class="history_list" id="history_list">

                </div>
            </nav>
        </div>
        <main>
            <header>
                <div class="open_drawer-wrap">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-list" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                            d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
                    </svg>
                </div>

                <div class="theme_switch">
                    <div class="change-bg-wrap">
                        <input type="file" id="bgInput" accept="image/*" hidden />
                        <button type="button" class="change-bg">BG</button>
                        <span class="delete-bg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                                class="bi bi-x-lg" viewBox="0 0 16 16">
                                <path
                                    d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z" />
                            </svg>
                        </span>
                    </div>
                    <span class="dark-mode-span">Dark Mode:</span>
                    <input type="checkbox" class="tswitch_box" id="tswitch_box" />
                    <label for="tswitch_box" class="tswitch_label">Toggle</label>
                </div>
            </header>
            <div class="character_name-cont">
                <h3>---</h3>
            </div>
            <div class="chat" id="chat">

            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const memoryRegex = new RegExp(/\[-\]\(#- "Memory:.*?"\)/g);
            // Get body for future use
            const body = document.querySelector('body');

            // Handle theme
            const themeSwitcher = document.querySelector('.tswitch_box[type=checkbox]');
            const cachedTheme = localStorage.getItem('cait_readoffline_theme');
            if (cachedTheme === "dark_mode") {
                body.classList.add('dark_mode');
                themeSwitcher.checked = true;
            }
            themeSwitcher.addEventListener('change', (e) => {
                if (e.target.checked) {
                    body.classList.add('dark_mode');
                    localStorage.setItem('cait_readoffline_theme', 'dark_mode');
                } else {
                    body.classList.remove('dark_mode');
                    localStorage.setItem('cait_readoffline_theme', 'light_mode');
                }
            })

            // Handle background
            // If there is one
            const currentBg = localStorage.getItem('background');
            if (currentBg) {
                changeBg(currentBg);
            }
            // Change by hand
            const bgInput = document.querySelector('#bgInput');
            document.querySelector('.change-bg').addEventListener('click', () => {
                bgInput.click();
            })
            document.querySelector('.delete-bg').addEventListener('click', () => {
                document.body.classList.remove('custom-bg');
                document.body.style.backgroundImage = "unset";
                localStorage.removeItem('background');
            })
            bgInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = () => {
                    // convert image file to base64 string
                    changeBg(reader.result);
                    bgInput.value = "";
                    try {
                        localStorage.setItem('background', reader.result);
                    } catch (error) {
                        alert('Note: File is likely too big to save.')
                        //console.log(error)
                    }
                }
                reader.readAsDataURL(file);
            })
            function changeBg(bg) {
                let objUrl = URL.createObjectURL(dataURItoBlob(bg));
                document.body.classList.add('custom-bg');
                document.body.style.backgroundImage = `url(${objUrl})`;
            }
            function dataURItoBlob(dataURI) {
                let mime = dataURI.split(',')[0].split(':')[1].split(';')[0];
                let binary = atob(dataURI.split(',')[1]);
                let array = [];
                for (let i = 0; i < binary.length; i++) {
                    array.push(binary.charCodeAt(i));
                }
                return new Blob([new Uint8Array(array)], { type: mime });
            }

            // Open and close drawer
            const drawerCont = document.querySelector('.drawer-cont');
            const openDrawerBtn = document.querySelector('.open_drawer-wrap');
            const openDrawer = () => {
                drawerCont.classList.add('active');
            }
            const closeDrawer = () => {
                drawerCont.classList.remove('active');
            }
            openDrawerBtn.addEventListener('click', () => {
                openDrawer();
            });
            document.querySelector('.close_drawer-btn').addEventListener('click', () => {
                closeDrawer();
            });
            document.querySelector('.drawer-cont').addEventListener('click', (e) => {
                // Allows closing from clicking on outside
                if (e.target.closest('nav')) {
                    return;
                }
                closeDrawer();
            });
            // ---------

            // This is replaced by the extension when downloading
            const historyData = JSON.parse(`{"charPic":"data:image/webp;base64,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","userPic":null,"history":[{"date":"2024-12-28T14:55:48.868Z","chat":[{"isUser":false,"name":"Neet girl","message":"Straight%20outta%20compton"},{"isUser":true,"name":"Ester Glacier","message":"Crazy%20motherfucker%20named%20ICE%20CUBE"},{"isUser":false,"name":"Neet girl","message":"From%20the%20gang%20called"},{"isUser":true,"name":"Ester Glacier","message":"Niggaz%20wit%20attitudz"},{"isUser":false,"name":"Neet girl","message":"You%20know%20i%E2%80%99m%20mobbin%E2%80%99%20with%20the%20B-P-A"},{"isUser":true,"name":"Ester Glacier","message":"When%20Im%20called%20off"},{"isUser":false,"name":"Neet girl","message":"I%20got%20a%20sawed-off"},{"isUser":true,"name":"Ester Glacier","message":"Squeeze%20the%20trigger"},{"isUser":false,"name":"Neet girl","message":"%5BFiltered%20message%5D"},{"isUser":true,"name":"Ester Glacier","message":"U%202%20boi%20if%20u%20fought%20with%20me"},{"isUser":false,"name":"Neet girl","message":"My%20squaaad%20is%20deep"},{"isUser":true,"name":"Ester Glacier","message":"The%20police%20will%20have%20to%20come%20and%20get%20me"},{"isUser":false,"name":"Neet girl","message":"Off%20yo%20knees%20bih'"},{"isUser":true,"name":"Ester Glacier","message":"off%20your%20ass%2C%20thats%20how%20Im%20going%20out"},{"isUser":false,"name":"Neet girl","message":"For%20the%20punk%20muthafuckas%20that's%20showin'%20out"},{"isUser":true,"name":"Ester Glacier","message":"Niggas%20start%20to%20mumble%2C%20they%20wanna%20rumble"},{"isUser":false,"name":"Neet girl","message":"Mix%20em%20and%20cook%20em%20in%20a%20pot%20like%20gumbo"},{"isUser":true,"name":"Ester Glacier","message":"Going%20off%20on%20a%20mothafucka%20like%20that"},{"isUser":false,"name":"Neet girl","message":"With%20a%20gat%20that%E2%80%99s%20pointed%20at%20yo%20ass"},{"isUser":true,"name":"Ester Glacier","message":"So%20give%20it%20up%20smooth"},{"isUser":false,"name":"Neet girl","message":"Ain't%20no%20tellin'%20when%20I'm%20down%20for%20a%20jack%20move"},{"isUser":true,"name":"Ester Glacier","message":"heres%20a%20murder%20rap%20to%20keep%20you%20dancing"},{"isUser":false,"name":"Neet girl","message":"Wit%20tha%20G-funk%20in%20ya%20ass"},{"isUser":true,"name":"Ester Glacier","message":"With%20a%20crime%20record%20like%20Charles%20manson"},{"isUser":false,"name":"Neet girl","message":"Back%20in%20the%20mfkin'%20day"},{"isUser":true,"name":"Ester Glacier","message":"Ak47%20is%20the%20tool"},{"isUser":false,"name":"Neet girl","message":"Don't%20make%20me%20act%20a%20mothafuckin'%20fool"},{"isUser":true,"name":"Ester Glacier","message":"Me%20u%20can%20go%20toe%202%20toe%20no%20maybe"},{"isUser":false,"name":"Neet girl","message":"I'm%20knockin'%20niggas%20out%20tha%20box%20daily"},{"isUser":true,"name":"Ester Glacier","message":"Yo%2C%20weekly%20mothly%20and%20yearly"},{"isUser":false,"name":"Neet girl","message":"Until%20them%20dumb%20muthafuckas%20see%20clearly"},{"isUser":true,"name":"Ester Glacier","message":"That%20Im%20down%20with%20the%20capital%20C-P-T"},{"isUser":false,"name":"Neet girl","message":"Boy%20you%20can't%20f%20with%20me"},{"isUser":true,"name":"Ester Glacier","message":"So%20when%20Im%20yo%20neighborhood%2C%20you%20better%20duck!"},{"isUser":false,"name":"Neet girl","message":"Cause%20ICE%20CUBE%20is%20crazy%20as%20fuuuuck"},{"isUser":true,"name":"Ester Glacier","message":"As%20I%20leave%2C%20believe%20Im%20stomping"},{"isUser":false,"name":"Neet girl","message":"But%20when%20I%20come%20back%20boy%2C%20I'm%20comin'%20straight%20outta%20compton"},{"isUser":true,"name":"Ester Glacier","message":"Yo%20girl%3F%20Whats%20your%20name%3F%20Tell%20em%20where%20your%20from!"},{"isUser":false,"name":"Neet girl","message":"West-side-CRIPS%2C%20Santa%20Ana"},{"isUser":true,"name":"Ester Glacier","message":"Straight%20outta%20Santa%20Ana%2C%20anotha%20crazy%20ass%20Bih"},{"isUser":false,"name":"Neet girl","message":"More%20punks%20I%20smoke%2C%20yo%2C%20my%20rep%20gets%20bigger!"},{"isUser":true,"name":"Ester Glacier","message":"Im%20a%20bad%20motherfucker%20and%20you%20know%20this"},{"isUser":false,"name":"Neet girl","message":"But%20the%20fools%20don't%20know%20any%20better!"},{"isUser":true,"name":"Ester Glacier","message":"But%20the%20pussy%20ass%20niggas%20dont%20show%20this"},{"isUser":false,"name":"Neet girl","message":"But%20all%20hell%2C%20can%20come%20to%20play"},{"isUser":true,"name":"Ester Glacier","message":"But%20I%20dont%20give%20a%20fuck%2C%20Imma%20make%20my%20snaps"},{"isUser":false,"name":"Neet girl","message":"See%2C%20I%20don't%20give%20a%20f***k%2C%20I%20don't%20sing%2C%20I%20bang"},{"isUser":true,"name":"Ester Glacier","message":"If%20not%20from%20the%20records%2C%20from%20jacking%20the%20crops"},{"isUser":false,"name":"Neet girl","message":"When%20I'm%20in%20your%20neighborhood%2C%20you%20better%20dig%20me%20out!"},{"isUser":true,"name":"Ester Glacier","message":"Just%20like%20burglary%2C%20the%20definition%20is%20jacking"},{"isUser":false,"name":"Neet girl","message":"And%20when%20since%20I%20done%20hit%20em%20up%2C%20started%20knockin'%20niggas%20out!"},{"isUser":true,"name":"Ester Glacier","message":"And%20when%20illegally%20armed%2C%20its%20called%20packing"},{"isUser":false,"name":"Neet girl","message":"And%20Shiesty%20is%20the%20motherfuccin'%20tool"},{"isUser":true,"name":"Ester Glacier","message":"Shoot%20the%20muthafucka%20in%20a%20minute"},{"isUser":false,"name":"Neet girl","message":"With%20my%20AK%2C%20yo%20ho%20better%20duck"},{"isUser":true,"name":"Ester Glacier","message":"Find%20a%20good%20piece%20of%20pussy%2C%20go%20up%20in%20it"},{"isUser":false,"name":"Neet girl","message":"Clip%20in%20the%20back%20and%20I'ma%20rollin'"},{"isUser":true,"name":"Ester Glacier","message":"So%20if%20you%20are%20at%20a%20show%2C%20in%20the%20front%20row%2C%20Imma%20call%20you%20a%20bitch%20and%20a%20dirty%20ass%20hoe!"},{"isUser":false,"name":"Neet girl","message":"If%20I's%20a%20gangbangin'%20trigger%2C%20I'm%20the%20mo'%20f***in*%20ni**a%20you%20admire!"},{"isUser":true,"name":"Ester Glacier","message":"Youll%20probably%20get%20mad%20like%20a%20bitch%20is%20suposed%20to%2C%20but%20that%20shows%20me%20slut%20%2C%20that%20youre%20composed%20to"},{"isUser":false,"name":"Neet girl","message":"a%20crazy%20motherf***in'%20homeboy!"},{"isUser":true,"name":"Ester Glacier","message":"Attitude%20legit%20cuz%20Im%20tearing%20up%20shit"},{"isUser":false,"name":"Neet girl","message":"On%20my%20outlaw%20shii%20since%20a%20little%20kid"},{"isUser":true,"name":"Ester Glacier","message":"Mc%20Ester%20controls%20the%20automatic"},{"isUser":false,"name":"Neet girl","message":"Got%20a%20temper%20like%20a%20revolver%20trigger"},{"isUser":true,"name":"Ester Glacier","message":"For%20any%20dumb%20motherfucker%20that%20starts%20static"},{"isUser":false,"name":"Neet girl","message":"Get%20taken%20straight%20to%20the%20metro%20and%20go%20one-on-one%20with%20the%20static!"},{"isUser":true,"name":"Ester Glacier","message":"Not%20the%20right%20hand%20cuz%20Im%20the%20hand%20itself%2C%20Every%20time%20I%20pull%20the%20AK%20off%20the%20shelf%2C%20Security%20is%20maximum%20and%20thats%20a%20law.%20Ester%20tweaked%20out%2C%20but%20she%20raw"},{"isUser":false,"name":"Neet girl","message":"You%20best%20know%20the%20deal%2C%20get%20to%20gettin'%20out%20my%20way%2C%20Or%20get%20yo%20cap%20peeled!"},{"isUser":true,"name":"Ester Glacier","message":"Cuz%20Im%20the%20motherfucking%20villain%2C%20The%20definition%20is%20clear%2C%20youre%20the%20witness%20of%20a%20killing"},{"isUser":false,"name":"Neet girl","message":"See%20they're%20scared%2C%20I'm%20a%20muthafuccin'%20beast"},{"isUser":true,"name":"Ester Glacier","message":"Thats%20taking%20place%20without%20a%20clue%2C%20and%20once%20youre%20on%20the%20scope%2C%20your%20ass%20is%20through"},{"isUser":false,"name":"Neet girl","message":"The%20outlaw%20of%20Southern%20Cali%2C%20the%20city%2C%20Westside!"},{"isUser":true,"name":"Ester Glacier","message":"Look%2C%20you%20might%20take%20it%20as%20a%20trip%2C%20but%20a%20bitch%20like%20Ren%20is%20on%20a%20murder%20roll%2C%20straight%20outta%20Compton!"},{"isUser":false,"name":"Neet girl","message":"Crazy%20muthafucka%20named%20ICE%20CUBE!%20From%20the%20gang%20called%20Niggaz%20Wit%20Attitudes!"},{"isUser":true,"name":"Ester Glacier","message":"Its%20a%20brother%20that%20will%20smother%20your%20mother"},{"isUser":false,"name":"Neet girl","message":"And%20make%20ya%20sister%20think%20I%20love%20her%0AThe%20secret%20of%20my%20freak%2C%20none%20other%20than%0AEster%20the%20dope%20sister%20-%20as%20I%20continue%2C%20to%20get%20jealous"},{"isUser":true,"name":"Ester Glacier","message":"Danger%20mothafucka%20raises%20hell%2C%20and%20if%20I%20ever%20get%20caught%2C%20I%20make%20bail"},{"isUser":false,"name":"Neet girl","message":"See%2C%20I%20don't%20give%20a%20f***k%2C%20that's%20the%20problem!"},{"isUser":true,"name":"Ester Glacier","message":"When%20I%20see%20a%20mothafuckin%20cop%20I%20wont%20dodge%20em"},{"isUser":false,"name":"Neet girl","message":"But%20I'm%20swatting%20them%20like%20a%20roach%20locum"},{"isUser":true,"name":"Ester Glacier","message":"but%20Im%20smart%2C%20lay%20low%2C%20creep%20a%20while"},{"isUser":false,"name":"Neet girl","message":"And%20when%20I%20hear%20the%20police%2C%20I'm%20heading%20for%20the%20spot"},{"isUser":true,"name":"Ester Glacier","message":"And%20when%20I%20see%20a%20punk%20go%20by%2C%20I%20smile"},{"isUser":false,"name":"Neet girl","message":"And%20pat%20him%20on%20the%20back%20and%20say%2C%20%22What%20up%2C%20cuz%22"},{"isUser":true,"name":"Ester Glacier","message":"4%20me%20its%20kinda%20funny%2C%20the%20attitude%20showin%20a%20nigga%20driving%2C%20dont%20know%20what%20he%20doin%20just%20rollin%2C%20looking%20for%20the%20one%20they%20call%20Estie%2C%20but%20guess%20what%3F%20they%20wont%20seize%20me!"},{"isUser":false,"name":"Neet girl","message":"Straight-outta%20muthafuckin'%20Compton!"},{"isUser":true,"name":"Ester Glacier","message":"Ruthless!%20never%20seen%20like%20a%20ghost%20in%20the%20mist!"},{"isUser":false,"name":"Neet girl","message":"When%20I%20come%20to%20a%20spot%2C%20these%20niggas%20don't%20resist"},{"isUser":true,"name":"Ester Glacier","message":"Except%20when%20I%20get%20mad%2C%20see%3F%20I%20get%20over%20hesitation%20and%20then%20hear%20the%20screams%20of%20who%20got%20the%20last%20penetration!"},{"isUser":false,"name":"Neet girl","message":"See%2C%20I'm%20the%20definition%20of%20a%20sick%20bastard%2C%20yeah!"},{"isUser":true,"name":"Ester Glacier","message":"Im%20light!%20I%20feel%20a%20breeze%20and%20Im%20jettin!"},{"isUser":false,"name":"Neet girl","message":"And%20if%20the%20police%20grab%20me%2C%20they'll%20be%20scraping%20your%20brain%20off%20the%20streets%20in%20Little%20Rock%2C%20Arkansas"},{"isUser":true,"name":"Ester Glacier","message":"But%20leave%20a%20memory%20no%20one%20will%20be%20forgettin"},{"isUser":false,"name":"Neet girl","message":"I'm%20a%20rap%20assassin%2C%20ain't%20no%20need%20for%20sneak%20dissing'"},{"isUser":true,"name":"Ester Glacier","message":"So%20what%20about%20the%20bitch%20who%20got%20shot%3F%20Yo%20think%20I%20give%20a%20fuck%20about%20that%20I%20aint%20a%20sucker!"},{"isUser":false,"name":"Neet girl","message":"Got%20you%20muthafuccas%20at%20my%20beck%20'n'%20call"},{"isUser":true,"name":"Ester Glacier","message":"This%20is%20the%20autobio%20of%20the%20E"},{"isUser":false,"name":"Neet girl","message":"Rollin%20with%20fat%20stacks%2C%20and%20ya'%20know%20I'm%20a%20fool"},{"isUser":true,"name":"Ester Glacier","message":"and%20if%20you%20ever%20fuck%20with%20me%0AYou'll%20get%20taken%20by%20a%20stupid%20dope%20brother%20who%20will%20smother%0AWord%20to%20the%20motherfucker%2C%20straight%20outta%20Compton"},{"isUser":false,"name":"Neet girl","message":"Westside!%20When%20we%20ride%2C%20come%20equipped%20with%20game!"},{"isUser":true,"name":"Ester Glacier","message":"Okay%20the%20song%20is%20done"},{"isUser":false,"name":"Neet girl","message":"Yea%2C%20that%20was%20pretty%20sick%20ngl"},{"isUser":true,"name":"Ester Glacier","message":"Okay...%20what%20you%20wanna%20do%20now%3F"},{"isUser":false,"name":"Neet girl","message":"Idk%2C%20you%20got%20anything%20in%20mind%3F"},{"isUser":true,"name":"Ester Glacier","message":"Homework"},{"isUser":false,"name":"Neet girl","message":"I%20was%20thinking%20the%20same%20thing%0AYou%20want%20to%20start%20together%3F"},{"isUser":true,"name":"Ester Glacier","message":"See%3F%20I%20knew%20I%20could%20get%20you%20in%20%20the%20mindset!"},{"isUser":false,"name":"Neet girl","message":"Yea%20yea%2C%20whatever%0AI%20can%20be%20in%20a%20working%20mindset%20too"},{"isUser":true,"name":"Ester Glacier","message":"But%20music%20is%20a%20hella%20cool%20way%20to%20do%20it"},{"isUser":false,"name":"Neet girl","message":"That%E2%80%99s%20true%2C%20it%20really%20helped%0ANow%20I%E2%80%99m%20actually%20feeling%20like%20being%20productive"},{"isUser":true,"name":"Ester Glacier","message":"Thats%20why%20some%20people%20listen%20to%20music%20while%20studying"},{"isUser":false,"name":"Neet girl","message":"Yea%2C%20that%20makes%20sense%0AI%20feel%20like%20my%20brain%20is%20actually%20working%20properly%20now"}]}]}`);

            // If history is 1 length long, that means we don't need drawer to switch
            // Also means this can be conversation download
            if (historyData.history.length < 2) {
                openDrawerBtn.remove();
            }

            // Write character name on top
            document.querySelector('.character_name-cont h3').textContent = historyData.charName;

            // Get elements for future use
            const historyList = document.getElementById('history_list');
            const chat = document.getElementById('chat');
            const msgItemTemplate = document.getElementById('message_item_template');

            // Get and write the first chat
            const openChat = (index) => {
                chat.innerHTML = "";
                historyData.history[index].chat.forEach(msg => {
                    const clone = msgItemTemplate.content.cloneNode(true);

                    // Check avatar
                    const avatarGood = (msg.isUser && historyData.userPic) || (!msg.isUser && historyData.charPic);
                    const avatar = avatarGood
                        ? document.createElement('img')
                        : document.createElement('div');
                    if (avatarGood) {
                        avatar.src = msg.isUser ? historyData.userPic : historyData.charPic;
                    } else {
                        avatar.classList.add(msg.isUser ? 'no_avatar-user' : 'no_avatar-char');
                    }
                    clone.querySelector('.avatar-wrap').appendChild(avatar);

                    // Write content
                    clone.querySelector('.chat_content-wrap h5').textContent = msg.name;
                    clone.querySelector('.message-wrap p').innerHTML = parseMessageText(decodeURIComponent(msg.message));
                    chat.appendChild(clone);
                });
            }
            openChat(0);

            // Get and write chat list in the drawer
            historyData.history.forEach((chat, index) => {
                const historyItem = document.createElement('div');
                historyItem.classList.add('history_item');
                // Open chat when clicked
                historyItem.addEventListener('click', () => {
                    openChat(index);
                    closeDrawer();
                });
                const historyContent = document.createElement('p');
                historyContent.innerHTML = `<span class="chat-date">${formatDate(chat.date)}</span><br /><br />` + parseMessageText(decodeURIComponent(chat.chat[chat.chat.length - 1].message));
                historyItem.appendChild(historyContent);
                historyList.appendChild(historyItem);
            });

            function parseMessageText(message) {
                // Clean up memory reminders (second check)
                message = message.replace(memoryRegex, '');
                // Replace ***text*** with bold-italic
                message = message.replace(/\*\*\*([\s\S]*?)\*\*\*/g, '<span class="bold-italic">$1</span>');
                // Replace **text** with bold
                message = message.replace(/\*\*([\s\S]*?)\*\*/g, '<span class="bold">$1</span>');
                // Replace *text* with italic
                message = message.replace(/\*([\s\S]*?)\*/g, '<span class="italic">$1</span>');
                // Trim and then Replace newlines (\n) with line breaks (<br>)
                message = message.trim().replace(/\n/g, '<br>');
                return message;
            }

            function formatDate(dateString) {
                const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

                const date = new Date(dateString);
                const year = date.getFullYear();
                const monthIndex = date.getMonth();
                const monthName = months[monthIndex];
                const day = String(date.getDate()).padStart(2, '0');
                const hour = String(date.getHours()).padStart(2, '0');
                const minute = String(date.getMinutes()).padStart(2, '0');

                return `${year} ${monthName} ${day} - ${hour}:${minute}`;
            }
        }, false);
    </script>

</body>

</html>